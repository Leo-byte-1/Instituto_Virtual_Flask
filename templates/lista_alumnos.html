{% import "macros.jinja2" as macros %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/normalize.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-lista_alumnos.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-macro.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/notifications.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/loading_spinner.css') }}">
    <title>Lista de alumnos</title>
</head>

<body>
    {{ macros.portada() }}

    <h1 class="titulo">Lista de Estudiantes</h1>

    <div class="cont-buscar">
        <form action="/buscar" method="POST">
            <input placeholder="Buscar por nombre, apellido o DNI..." type="text" name="buscar">
            <button type="submit">üîç Buscar</button>
        </form>
    </div>

    <div class="cont-table">
        <table class="datos">
            <thead>
                <tr>
                    <th>DNI</th>
                    <th>Nombre</th>
                    <th>Apellido</th>
                    <th>Edad</th>
                    <th>Editar</th>
                    <th>Eliminar</th>
                </tr>
            </thead>

            <tbody>
                {% if data and data|length > 0 %}
                {% for d in data %}
                <tr>
                    <td class="id">{{ d.dni }}</td>
                    <td>{{ d.nombre }}</td>
                    <td>{{ d.apellido }}</td>
                    <td>{{ d.edad }}</td>
                    <td>
                        <button class="btn-action" type="button"
                            data-id="{{ d.id }}"
                            data-nombre="{{ d.nombre }}"
                            data-apellido="{{ d.apellido }}"
                            data-edad="{{ d.edad }}"
                            data-dni="{{ d.dni }}">‚úèÔ∏è Editar</button>
                    </td>
                    <td>
                        <button type="button" class="btn-action-delete"
                            onclick="confirmarEliminacion(event, '{{ d.nombre }}', '{{ d.apellido }}', '{{ d.id }}')">
                            üóëÔ∏è Eliminar
                        </button>
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="6" class="no-data">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìã</div>
                            <h3 class="empty-state-title">No hay estudiantes registrados</h3>
                            <p class="empty-state-description">Comienza agregando tu primer estudiante al sistema</p>
                            <a href="{{ url_for('registrar') }}" class="empty-state-action">+ Agregar Estudiante</a>
                        </div>
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <a href="{{url_for('registrar')}}"><button class="b-agregar">Agregar Alumno</button></a>

    <!-- Modal √∫nico reutilizable -->
    <div class="modal-overlay" id="modalOverlay" aria-hidden="true">
        <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Editar alumno</h2>
                <button class="close-btn" id="closeModal" type="button">&times;</button>
            </div>
            <div class="modal-body">
                 <form id="editForm" action="" method="POST">
                        <label>
                            <span>Nombre</span>
                            <input id="inputNombre" type="text" name="nombre" value="" placeholder="Ingrese el nombre" required>
                        </label>
                        <label>
                            <span>Apellido</span>
                            <input id="inputApellido" type="text" name="apellido" value="" placeholder="Ingrese el apellido" required>
                        </label>
                        <label>
                            <span>Edad</span>
                            <input id="inputEdad" type="number" name="edad" value="" placeholder="Ingrese la edad" min="1" max="120" required>
                        </label>
                        <label>
                            <span>DNI</span>
                            <input id="inputDni" type="number" name="dni" value="" placeholder="Ingrese el DNI" required>
                        </label>
                  </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-secondary" id="cancelBtn" type="button">Cancelar</button>
                <button class="modal-btn btn-primary" id="acceptBtn" type="button">Guardar Cambios</button>
            </div>
        </div>
    </div>

    {{ macros.footer() }}

    <!-- Scripts al final del body -->
    <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
    <script src="{{ url_for('static', filename='js/utils_js.js') }}"></script>
    <script src="{{ url_for('static', filename='js/pagination_js.js') }}"></script>
    <script src="{{ url_for('static', filename='js/CodigoListaAlumnos.js') }}"></script>
</body>

</html>